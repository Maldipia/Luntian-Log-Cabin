<?php
/**
 * LLC 2.0 - COMPLETE PHP Lead Generation System
 * Optimized for A-B Testing and Conversion
 * ALL CODE INCLUDED - NO MISSING PIECES
 */

// Configuration
$config = [
    'site_name' => 'LLC 2.0',
    'logo_url' => 'logo.png',
    'hero_bg' => 'cover2.0.png',
    'promo_code' => 'SAVE20',
    'promo_discount' => '20%',
    'enable_ab_testing' => true,
    'analytics_id' => 'GA-XXXXXXXXX',
    'enable_email_capture' => true,
    'enable_exit_intent' => true,
    'enable_testimonials' => true,
    'lead_magnet_title' => 'Get 25% Off Your First Stay',
    'lead_magnet_subtitle' => 'Join our VIP list for exclusive deals and early access',
    'email_placeholder' => 'Enter your email for exclusive deals...'
];

// A-B Testing Configuration
$ab_variants = [
    'button_style' => ['primary', 'urgent'],
    'social_proof' => ['enabled', 'disabled'],
    'urgency_level' => ['high', 'medium', 'low']
];

// Sample data - replace with database calls
$rooms = [
    [
        'id' => 1,
        'name' => 'Deluxe Business Suite',
        'tagline' => 'Perfect for business travelers',
        'description' => 'Spacious room with modern amenities and city views.',
        'price' => 199,
        'original_price' => 249,
        'image' => 'room1.jpg',
        'features' => ['Free WiFi', 'City View', 'Work Desk', 'Mini Bar'],
        'popular' => true
    ],
    [
        'id' => 2,
        'name' => 'Premium King Room',
        'tagline' => 'Luxury and comfort combined',
        'description' => 'King-sized bed with premium linens and spa bathroom.',
        'price' => 159,
        'original_price' => 199,
        'image' => 'room2.jpg',
        'features' => ['King Bed', 'Spa Bathroom', 'Premium Linens', 'Smart TV'],
        'popular' => false
    ],
    [
        'id' => 3,
        'name' => 'Executive Corner Suite',
        'tagline' => 'Ultimate luxury experience',
        'description' => 'Corner suite with panoramic views and premium amenities.',
        'price' => 299,
        'original_price' => 349,
        'image' => 'room3.jpg',
        'features' => ['Corner Views', 'Executive Lounge', 'Premium Bathroom', 'Balcony'],
        'popular' => false
    ]
];

$packages = [
    [
        'id' => 1,
        'name' => 'Weekend Getaway',
        'description' => 'Perfect for a quick escape',
        'price' => 299,
        'original_price' => 399,
        'duration' => '2 nights',
        'includes' => [
            '2 nights accommodation',
            'Breakfast included',
            'Late checkout',
            'Welcome drink',
            'Free parking'
        ],
        'popular' => true
    ],
    [
        'id' => 2,
        'name' => 'Business Package',
        'description' => 'Everything you need for business',
        'price' => 449,
        'original_price' => 549,
        'duration' => '3 nights',
        'includes' => [
            '3 nights accommodation',
            'Meeting room access',
            'Business center',
            'Express laundry',
            'Airport transfer'
        ],
        'popular' => false
    ],
    [
        'id' => 3,
        'name' => 'Luxury Experience',
        'description' => 'Ultimate luxury package',
        'price' => 699,
        'original_price' => 899,
        'duration' => '4 nights',
        'includes' => [
            '4 nights in premium suite',
            'Spa treatments',
            'Fine dining',
            'Concierge service',
            'VIP amenities'
        ],
        'popular' => false
    ]
];

$gallery_images = [
    ['url' => 'gallery1.jpg', 'alt' => 'Luxury room interior'],
    ['url' => 'gallery2.jpg', 'alt' => 'Hotel amenities'],
    ['url' => 'gallery3.jpg', 'alt' => 'Building exterior'],
    ['url' => 'gallery4.jpg', 'alt' => 'Restaurant dining'],
    ['url' => 'gallery5.jpg', 'alt' => 'Spa facilities'],
    ['url' => 'gallery6.jpg', 'alt' => 'Conference room']
];

$rules = [
    [
        'title' => 'Check-in / Check-out',
        'content' => 'Check-in: 3:00 PM | Check-out: 11:00 AM<br>Early check-in and late check-out available upon request.'
    ],
    [
        'title' => 'Cancellation Policy',
        'content' => 'Free cancellation up to 24 hours before arrival. Cancellations made within 24 hours will incur a one-night charge.'
    ],
    [
        'title' => 'Pet Policy',
        'content' => 'We welcome well-behaved pets with a $50 cleaning fee. Please inform us during booking.'
    ],
    [
        'title' => 'Smoking Policy',
        'content' => 'All rooms are non-smoking. Smoking areas are available on designated outdoor terraces.'
    ]
];

// Customer testimonials data
$testimonials = [
    [
        'name' => 'Sarah Johnson',
        'location' => 'New York, NY',
        'rating' => 5,
        'text' => 'Absolutely incredible experience! The room was pristine and the service was outstanding.',
        'image' => 'testimonial1.jpg',
        'verified' => true
    ],
    [
        'name' => 'Michael Chen',
        'location' => 'San Francisco, CA', 
        'rating' => 5,
        'text' => 'Perfect for business travel. Great location and all the amenities I needed.',
        'image' => 'testimonial2.jpg',
        'verified' => true
    ],
    [
        'name' => 'Emma Rodriguez',
        'location' => 'Austin, TX',
        'rating' => 5,
        'text' => 'The best value for money! Will definitely be staying here again on my next visit.',
        'image' => 'testimonial3.jpg',
        'verified' => true
    ]
];

// Trust indicators
$trust_badges = [
    ['icon' => 'ðŸ”’', 'text' => 'SSL Secured'],
    ['icon' => 'ðŸ’³', 'text' => 'Secure Payment'],
    ['icon' => 'ðŸ“ž', 'text' => '24/7 Support'],
    ['icon' => 'âœ…', 'text' => 'Verified Reviews'],
    ['icon' => 'ðŸ†', 'text' => '5-Star Rated']
];

// Helper functions
function formatPrice($price) {
    return '$' . number_format($price, 0);
}

function calculateSavings($original, $current) {
    return round((($original - $current) / $original) * 100);
}

function getButtonClass($variant = 'primary') {
    $classes = [
        'primary' => 'btn-primary',
        'urgent' => 'btn-urgent',
        'secondary' => 'btn-secondary'
    ];
    return $classes[$variant] ?? 'btn-primary';
}

// Determine A-B test variant
function getVariant($test_name) {
    global $ab_variants;
    if (!isset($_SESSION['ab_variants'])) {
        $_SESSION['ab_variants'] = [];
    }
    
    if (!isset($_SESSION['ab_variants'][$test_name])) {
        $variants = $ab_variants[$test_name] ?? ['default'];
        $_SESSION['ab_variants'][$test_name] = $variants[array_rand($variants)];
    }
    
    return $_SESSION['ab_variants'][$test_name];
}

// Lead capture form handler
function handleLeadCapture() {
    if ($_POST['action'] === 'email_signup') {
        $email = filter_var($_POST['email'], FILTER_SANITIZE_EMAIL);
        $source = $_POST['source'] ?? 'unknown';
        
        if (filter_var($email, FILTER_VALIDATE_EMAIL)) {
            // Save to database or send to email service
            // Example: saveLeadToDatabase($email, $source);
            // For now, just log it (replace with your database code)
            error_log("New lead captured: $email from $source");
            
            return ['success' => true, 'message' => 'Thank you! Check your email for exclusive deals.'];
        }
        
        return ['success' => false, 'message' => 'Please enter a valid email address.'];
    }
    
    return null;
}

// Start session for A-B testing
session_start();

// Process lead capture if form submitted
$lead_result = null;
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $lead_result = handleLeadCapture();
}

// Get current variants
$button_variant = getVariant('button_style');
$social_proof_variant = getVariant('social_proof');
$urgency_variant = getVariant('urgency_level');

// Build variant classes
$body_classes = [];
if ($button_variant === 'urgent') $body_classes[] = 'variant-urgent';
if ($social_proof_variant === 'enabled') $body_classes[] = 'variant-social';
if ($urgency_variant === 'high') $body_classes[] = 'variant-high-urgency';

$body_class = implode(' ', $body_classes);
?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><?= $config['site_name'] ?> - Premium Accommodations</title>
    <meta name="description" content="Experience luxury and comfort in our carefully curated spaces. Book your perfect stay today.">
    
    <!-- Analytics -->
    <?php if ($config['analytics_id']): ?>
    <script async src="https://www.googletagmanager.com/gtag/js?id=<?= $config['analytics_id'] ?>"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', '<?= $config['analytics_id'] ?>');
    </script>
    <?php endif; ?>
    
    <style>
:root {
  --bg: #fafafa;
  --text: #1a1a1a;
  --text-light: #4a5568;
  --brand-primary: #22c55e;
  --brand-secondary: #16a34a;
  --accent-cta: #ef4444;
  --accent-price: #dc2626;
  --card-bg: #ffffff;
  --border-light: #e2e8f0;
  --border-focus: #3b82f6;
  --shadow-card: 0 4px 12px rgba(0,0,0,0.05);
  --shadow-hover: 0 8px 24px rgba(0,0,0,0.12);
  --radius: 12px;
  --font-base: clamp(16px, 2.2vw, 18px);
  --font-small: clamp(14px, 1.9vw, 16px);
  --font-large: clamp(18px, 2.5vw, 20px);
  --font-h1: clamp(36px, 5vw, 56px);
  --font-h2: clamp(28px, 3.5vw, 40px);
  --font-h3: clamp(22px, 2.8vw, 32px);
  --space-xs: 8px;
  --space-sm: 16px;
  --space-md: 24px;
  --space-lg: 32px;
  --space-xl: 48px;
}

* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; }

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  color: var(--text);
  background: var(--bg);
  line-height: 1.6;
  font-size: var(--font-base);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

h1 { font-size: var(--font-h1); font-weight: 800; line-height: 1.1; letter-spacing: -0.025em; margin-bottom: var(--space-sm); }
h2 { font-size: var(--font-h2); font-weight: 700; line-height: 1.2; margin-bottom: var(--space-sm); }
h3 { font-size: var(--font-h3); font-weight: 600; line-height: 1.3; margin-bottom: var(--space-sm); }
p { font-size: var(--font-base); line-height: 1.65; margin-bottom: var(--space-sm); color: var(--text-light); }

img { max-width: 100%; display: block; }
a { color: inherit; text-decoration: none; }
hr { border: none; border-top: 1px solid var(--border-light); margin: 20px 0; }

.container { width: min(1200px, calc(100% - 2rem)); margin: 0 auto; padding: 0 var(--space-sm); }
.section { padding: var(--space-xl) 0; }
.grid { display: grid; gap: var(--space-md); }
.grid-2 { grid-template-columns: 1fr; }
.grid-3 { grid-template-columns: 1fr; }

@media (min-width: 768px) { .grid-2 { grid-template-columns: repeat(2, 1fr); } }
@media (min-width: 900px) { .grid-3 { grid-template-columns: repeat(3, 1fr); } }

.btn, .btn-primary, .btn-secondary, .btn-urgent, .btn-ghost, .book-btn {
  display: inline-flex; align-items: center; justify-content: center; padding: 14px var(--space-md);
  border: none; border-radius: var(--radius); font-weight: 600; font-size: var(--font-base);
  text-decoration: none; cursor: pointer; transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  white-space: nowrap; min-height: 48px;
}

.btn-primary, .book-btn, .btn { background: var(--brand-primary); color: white; box-shadow: 0 2px 8px rgba(34, 197, 94, 0.3); }
.btn-primary:hover, .book-btn:hover, .btn:hover { background: var(--brand-secondary); transform: translateY(-1px); box-shadow: 0 4px 16px rgba(34, 197, 94, 0.4); }

.btn-urgent { background: var(--accent-cta); color: white; box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3); }
.btn-urgent:hover { background: #dc2626; transform: translateY(-1px); box-shadow: 0 4px 16px rgba(239, 68, 68, 0.4); }

.btn-secondary, .btn.ghost { background: transparent; color: var(--text); border: 2px solid var(--border-light); }
.btn-secondary:hover, .btn.ghost:hover { border-color: var(--brand-primary); color: var(--brand-primary); background: rgba(34, 197, 94, 0.05); }

.btn-ghost { padding: 12px var(--space-sm); min-height: auto; border: none; color: var(--text-light); }

.header {
  position: sticky; top: 0; z-index: 100; background: rgba(250, 250, 250, 0.95);
  backdrop-filter: blur(12px) saturate(180%); border-bottom: 1px solid var(--border-light);
}

.nav { display: flex; align-items: center; justify-content: space-between; padding: var(--space-sm) 0; }
.logo img { height: 44px; width: auto; }

.nav-links { display: none; gap: var(--space-md); list-style: none; }
.nav-links a { padding: var(--space-xs) var(--space-sm); border-radius: 8px; font-weight: 500; transition: all 0.2s ease; }
.nav-links a:hover { background: rgba(34, 197, 94, 0.1); color: var(--brand-primary); }

@media (min-width: 880px) { .nav-links { display: flex; } }

.promo-banner {
  position: relative; display: flex; align-items: center; justify-content: center; padding: var(--space-sm) var(--space-xl);
  background: linear-gradient(90deg, #fef3c7, #fde68a); color: #92400e; font-weight: 600; text-align: center; border-bottom: 1px solid #f59e0b;
}

.close-btn { position: absolute; right: var(--space-sm); cursor: pointer; font-size: 20px; opacity: 0.7; transition: opacity 0.2s ease; }
.close-btn:hover { opacity: 1; }

.hero {
  background: linear-gradient(135deg, rgba(250,250,250,0.9), rgba(255,255,255,0.7)), url('<?= $config['hero_bg'] ?>') center/cover no-repeat;
  min-height: 65vh; display: flex; align-items: center; justify-content: center; text-align: center; position: relative;
}

.hero::after { content: ""; position: absolute; inset: 0; background: linear-gradient(to bottom, rgba(250,250,250,0.1), rgba(250,250,250,0.7)); pointer-events: none; }

.hero-content { position: relative; z-index: 1; max-width: 700px; padding: var(--space-lg); }
.hero h1 { color: var(--text); margin-bottom: var(--space-md); }
.hero p { font-size: var(--font-large); color: var(--text-light); margin-bottom: var(--space-lg); font-weight: 500; }

.cta-buttons, .cta-group { display: flex; gap: var(--space-sm); justify-content: center; flex-wrap: wrap; margin-top: var(--space-lg); }

.card { background: var(--card-bg); border: 1px solid var(--border-light); border-radius: var(--radius); padding: var(--space-md); box-shadow: var(--shadow-card); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); position: relative; }

.card:hover { transform: translateY(-4px); box-shadow: var(--shadow-hover); border-color: var(--brand-primary); }

.card-image { margin: calc(-1 * var(--space-md)) calc(-1 * var(--space-md)) var(--space-md); border-radius: var(--radius) var(--radius) 0 0; overflow: hidden; }
.card-image img { width: 100%; height: 200px; object-fit: cover; transition: transform 0.3s ease; }
.card:hover .card-image img { transform: scale(1.05); }

.card-tagline { color: var(--text-light); font-style: italic; margin: 8px 0 var(--space-sm); font-size: var(--font-small); }
.card-actions { display: flex; gap: var(--space-xs); flex-wrap: wrap; margin-top: var(--space-md); }

.price-wrapper { display: flex; align-items: baseline; gap: var(--space-xs); margin: var(--space-sm) 0; }
.price { font-weight: 800; font-size: var(--font-large); color: var(--accent-price); }
.strike { text-decoration: line-through; color: var(--text-light); margin-left: 8px; font-weight: normal; }
.savings { background: var(--accent-cta); color: white; padding: 2px 6px; border-radius: 4px; font-size: 12px; font-weight: 600; }

.expandable { background: var(--card-bg); border: 1px solid var(--border-light); border-radius: var(--radius); margin: var(--space-sm) 0; overflow: hidden; }
.expandable summary { padding: var(--space-sm) var(--space-md); cursor: pointer; font-weight: 600; background: rgba(34, 197, 94, 0.02); border-bottom: 1px solid var(--border-light); transition: background 0.2s ease; }
.expandable summary:hover { background: rgba(34, 197, 94, 0.05); }
.expandable-content { padding: var(--space-md); }

.gallery { display: grid; gap: var(--space-sm); grid-template-columns: repeat(2, 1fr); }
@media (min-width: 900px) { .gallery { grid-template-columns: repeat(3, 1fr); } }

.gallery img { width: 100%; border-radius: var(--radius); border: 1px solid var(--border-light); aspect-ratio: 4/3; object-fit: cover; transition: transform 0.2s ease; }
.gallery img:hover { transform: scale(1.02); }

.floating-book { position: fixed; bottom: var(--space-md); right: var(--space-md); z-index: 999; }

.floating-toggle { background: var(--brand-primary); color: white; padding: var(--space-sm) var(--space-md); border-radius: 50px; border: none; font-weight: 700; cursor: pointer; box-shadow: 0 4px 20px rgba(34, 197, 94, 0.4); transition: all 0.2s ease; }

.floating-toggle:hover { background: var(--brand-secondary); transform: translateY(-2px); box-shadow: 0 8px 32px rgba(34, 197, 94, 0.5); }

.floating-menu { display: none; flex-direction: column; position: absolute; bottom: 70px; right: 0; background: white; border: 1px solid var(--border-light); border-radius: var(--radius); box-shadow: var(--shadow-hover); min-width: 280px; overflow: hidden; }

.floating-menu a { padding: var(--space-sm) var(--space-md); border-bottom: 1px solid var(--border-light); white-space: nowrap; transition: background 0.2s ease; font-weight: 500; }
.floating-menu a:hover { background: rgba(34, 197, 94, 0.05); }
.floating-menu a:last-child { border-bottom: none; }
.floating-book.open .floating-menu { display: flex; }

.footer { background: var(--card-bg); border-top: 1px solid var(--border-light); padding: var(--space-xl) 0 var(--space-md); text-align: center; color: var(--text-light); }

.popular-badge { position: absolute; top: var(--space-sm); right: var(--space-sm); background: var(--accent-cta); color: white; padding: 4px var(--space-xs); border-radius: 6px; font-size: 12px; font-weight: 600; }

.features-list { list-style: none; margin: var(--space-sm) 0; }
.features-list li { padding: 4px 0; color: var(--text-light); font-size: var(--font-small); }
.features-list li:before { content: "âœ“"; color: var(--brand-primary); font-weight: bold; margin-right: 8px; }

/* Lead Capture Styles */
.lead-capture-section {
    background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
    color: white;
    text-align: center;
    padding: var(--space-xl) 0;
    margin: var(--space-xl) 0;
}

.lead-capture-form {
    display: flex;
    gap: var(--space-sm);
    max-width: 400px;
    margin: var(--space-md) auto 0;
    flex-wrap: wrap;
    justify-content: center;
}

.email-input {
    flex: 1;
    min-width: 250px;
    padding: 14px var(--space-md);
    border: none;
    border-radius: var(--radius);
    font-size: var(--font-base);
    background: rgba(255,255,255,0.95);
    color: var(--text);
}

.email-input:focus {
    outline: 3px solid rgba(255,255,255,0.5);
    background: white;
}

.email-submit {
    background: var(--accent-cta);
    color: white;
    border: none;
    padding: 14px var(--space-md);
    border-radius: var(--radius);
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s ease;
    white-space: nowrap;
}

.email-submit:hover {
    background: #dc2626;
    transform: translateY(-1px);
}

/* Testimonials */
.testimonials-grid {
    display: grid;
    gap: var(--space-md);
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    margin-top: var(--space-lg);
}

.testimonial-card {
    background: var(--card-bg);
    padding: var(--space-md);
    border-radius: var(--radius);
    box-shadow: var(--shadow-card);
    border-left: 4px solid var(--brand-primary);
}

.testimonial-header {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    margin-bottom: var(--space-sm);
}

.testimonial-avatar {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    object-fit: cover;
}

.testimonial-info h4 {
    margin: 0;
    font-size: var(--font-base);
    color: var(--text);
}

.testimonial-location {
    font-size: var(--font-small);
    color: var(--text-light);
    margin: 0;
}

.testimonial-rating {
    color: #fbbf24;
    margin-bottom: var(--space-sm);
}

.testimonial-text {
    font-style: italic;
    color: var(--text-light);
    line-height: 1.6;
}

.verified-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: 12px;
    color: var(--brand-primary);
    font-weight: 600;
    margin-top: var(--space-xs);
}

/* Trust Badges */
.trust-badges {
    display: flex;
    justify-content: center;
    gap: var(--space-md);
    flex-wrap: wrap;
    margin: var(--space-lg) 0;
    padding: var(--space-md);
    background: var(--card-bg);
    border-radius: var(--radius);
    border: 1px solid var(--border-light);
}

.trust-badge {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
    font-size: var(--font-small);
    color: var(--text-light);
    font-weight: 500;
}

.trust-badge-icon {
    font-size: 16px;
}

/* Exit Intent Modal */
.exit-intent-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    z-index: 10000;
    justify-content: center;
    align-items: center;
}

.exit-intent-content {
    background: white;
    padding: var(--space-xl);
    border-radius: var(--radius);
    max-width: 500px;
    margin: var(--space-md);
    text-align: center;
    position: relative;
}

.exit-intent-close {
    position: absolute;
    top: var(--space-sm);
    right: var(--space-md);
    font-size: 24px;
    cursor: pointer;
    color: var(--text-light);
}

.exit-intent-close:hover {
    color: var(--text);
}

/* Success/Error Messages */
.message {
    padding: var(--space-sm) var(--space-md);
    border-radius: var(--radius);
    margin: var(--space-sm) 0;
    font-weight: 500;
}

.message.success {
    background: #dcfce7;
    color: #166534;
    border: 1px solid #bbf7d0;
}

.message.error {
    background: #fef2f2;
    color: #dc2626;
    border: 1px solid #fecaca;
}

.variant-urgent .btn-primary { background: var(--accent-cta); animation: attention 3s ease-in-out infinite; }
@keyframes attention { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.03); } }

.variant-social .card.popular::after { content: "ðŸ”¥ Popular Choice"; position: absolute; top: var(--space-sm); right: var(--space-sm); background: var(--accent-cta); color: white; padding: 4px var(--space-xs); border-radius: 6px; font-size: 12px; font-weight: 600; }

:focus-visible { outline: 3px solid var(--border-focus); outline-offset: 2px; border-radius: 4px; }

@media (max-width: 767px) {
  .container { padding: 0 var(--space-sm); }
  .section { padding: var(--space-md) 0; }
  .hero { min-height: 50vh; }
  .cta-buttons, .cta-group { flex-direction: column; align-items: center; }
  .btn { width: 100%; max-width: 300px; }
  .card-actions { flex-direction: column; }
  .gallery { grid-template-columns: 1fr; }
  
  .lead-capture-form {
      flex-direction: column;
      align-items: center;
  }
  
  .email-input {
      min-width: auto;
      width: 100%;
      max-width: 300px;
  }
  
  .trust-badges {
      flex-direction: column;
      align-items: center;
      gap: var(--space-sm);
  }
}
    </style>
</head>
<body class="<?= $body_class ?>">
    <header class="header">
        <nav class="nav container">
            <div class="logo">
                <img src="<?= $config['logo_url'] ?>" alt="<?= $config['site_name'] ?>">
            </div>
            <ul class="nav-links">
                <li><a href="#rooms">Rooms</a></li>
                <li><a href="#packages">Packages</a></li>
                <li><a href="#gallery">Gallery</a></li>
                <li><a href="#rules">Rules</a></li>
            </ul>
            <a href="#book" class="book-btn" onclick="gtag('event', 'click', {'event_category': 'CTA', 'event_label': 'Header Book Now'});">Book Now</a>
        </nav>
    </header>

    <?php if ($urgency_variant === 'high'): ?>
    <div class="promo-banner" id="promoBanner">
        <span>ðŸ”¥ Limited Time: <?= $config['promo_discount'] ?> Off All Bookings - Use Code <?= $config['promo_code'] ?></span>
        <span class="close-btn" onclick="closeBanner()">&times;</span>
    </div>
    <?php endif; ?>

    <section class="hero">
        <div class="hero-content">
            <h1>Premium Accommodations</h1>
            <p>Experience luxury and comfort in our carefully curated spaces</p>
            <div class="cta-buttons">
                <a href="#book" class="<?= getButtonClass($button_variant) ?>" onclick="gtag('event', 'click', {'event_category': 'CTA', 'event_label': 'Hero Primary'});">Book Your Stay</a>
                <a href="#rooms" class="btn-secondary">View Rooms</a>
            </div>
        </div>
    </section>

    <?php if ($config['enable_email_capture']): ?>
    <section class="lead-capture-section">
        <div class="container">
            <h2><?= $config['lead_magnet_title'] ?></h2>
            <p><?= $config['lead_magnet_subtitle'] ?></p>
            
            <?php if ($lead_result): ?>
                <div class="message <?= $lead_result['success'] ? 'success' : 'error' ?>">
                    <?= $lead_result['message'] ?>
                </div>
            <?php endif; ?>
            
            <form method="POST" class="lead-capture-form" onsubmit="trackLeadCapture('hero')">
                <input type="hidden" name="action" value="email_signup">
                <input type="hidden" name="source" value="hero_section">
                <input type="email" 
                       name="email" 
                       class="email-input" 
                       placeholder="<?= $config['email_placeholder'] ?>" 
                       required>
                <button type="submit" class="email-submit">Get Exclusive Deals</button>
            </form>
        </div>
    </section>
    <?php endif; ?>

    <section class="section">
        <div class="container">
            <div class="trust-badges">
                <?php foreach ($trust_badges as $badge): ?>
                <div class="trust-badge">
                    <span class="trust-badge-icon"><?= $badge['icon'] ?></span>
                    <span><?= $badge['text'] ?></span>
                </div>
                <?php endforeach; ?>
            </div>
        </div>
    </section>

    <section class="section" id="rooms">
        <div class="container">
            <h2>Our Rooms</h2>
            <div class="grid grid-2">
                <?php foreach ($rooms as $room): ?>
                <div class="card <?= $room['popular'] ? 'popular' : '' ?>">
                    <?php if ($room['popular'] && $social_proof_variant === 'enabled'): ?>
                        <div class="popular-badge">ðŸ”¥ Popular Choice</div>
                    <?php endif; ?>
                    
                    <div class="card-image">
                        <img src="<?= $room['image'] ?>" alt="<?= $room['name'] ?>">
                    </div>
                    <div class="card-body">
                        <h3><?= $room['name'] ?></h3>
                        <p class="card-tagline"><?= $room['tagline'] ?></p>
                        <p><?= $room['description'] ?></p>
                        
                        <ul class="features-list">
                            <?php foreach (array_slice($room['features'], 0, 3) as $feature): ?>
                            <li><?= $feature ?></li>
                            <?php endforeach; ?>
                        </ul>
                        
                        <div class="price-wrapper">
                            <span class="price"><?= formatPrice($room['price']) ?>/night</span>
                            <?php if ($room['original_price'] > $room['price']): ?>
                                <span class="strike"><?= formatPrice($room['original_price']) ?></span>
                                <span class="savings">Save <?= calculateSavings($room['original_price'], $room['price']) ?>%</span>
                            <?php endif; ?>
                        </div>
                        
                        <div class="card-actions">
                            <a href="#book?room=<?= $room['id'] ?>" class="<?= getButtonClass($button_variant) ?>" 
                               onclick="gtag('event', 'click', {'event_category': 'Room', 'event_label': '<?= $room['name'] ?>'});">Book Now</a>
                            <a href="#details?room=<?= $room['id'] ?>" class="btn-ghost">Details</a>
                        </div>
                    </div>
                </div>
                <?php endforeach; ?>
            </div>
        </div>
    </section>

    <section class="section" id="packages">
        <div class="container">
            <h2>Special Packages</h2>
            <div class="grid grid-3">
                <?php foreach ($packages as $package): ?>
                <div class="card <?= $package['popular'] ? 'popular' : '' ?>">
                    <?php if ($package['popular'] && $social_proof_variant === 'enabled'): ?>
                        <div class="popular-badge">ðŸ”¥ Most Popular</div>
                    <?php endif; ?>
                    
                    <h3><?= $package['name'] ?></h3>
                    <p><?= $package['description'] ?></p>
                    
                    <div class="price-wrapper">
                        <span class="price"><?= formatPrice($package['price']) ?></span>
                        <?php if ($package['original_price'] > $package['price']): ?>
                            <span class="strike"><?= formatPrice($package['original_price']) ?></span>
                            <span class="savings">Save <?= calculateSavings($package['original_price'], $package['price']) ?>%</span>
                        <?php endif; ?>
                    </div>
                    <p class="card-tagline"><?= $package['duration'] ?></p>
                    
                    <details class="expandable">
                        <summary>What's Included</summary>
                        <div class="expandable-content">
                            <ul class="features-list">
                                <?php foreach ($package['includes'] as $include): ?>
                                <li><?= $include ?></li>
                                <?php endforeach; ?>
                            </ul>
                        </div>
                    </details>
                    
                    <div class="card-actions">
                        <a href="#book?package=<?= $package['id'] ?>" class="<?= getButtonClass($button_variant) ?>" 
                           onclick="gtag('event', 'click', {'event_category': 'Package', 'event_label': '<?= $package['name'] ?>'});">Book Package</a>
                    </div>
                </div>
                <?php endforeach; ?>
            </div>
        </div>
    </section>

    <?php if ($config['enable_testimonials']): ?>
    <section class="section">
        <div class="container">
            <h2 style="text-align: center;">What Our Guests Say</h2>
            <div class="testimonials-grid">
                <?php foreach ($testimonials as $testimonial): ?>
                <div class="testimonial-card">
                    <div class="testimonial-header">
                        <img src="<?= $testimonial['image'] ?>" alt="<?= $testimonial['name'] ?>" class="testimonial-avatar">
                        <div class="testimonial-info">
                            <h4><?= $testimonial['name'] ?></h4>
                            <p class="testimonial-location"><?= $testimonial['location'] ?></p>
                        </div>
                    </div>
                    
                    <div class="testimonial-rating">
                        <?= str_repeat('â­', $testimonial['rating']) ?>
                    </div>
                    
                    <p class="testimonial-text">"<?= $testimonial['text'] ?>"</p>
                    
                    <?php if ($testimonial['verified']): ?>
                    <div class="verified-badge">
                        <span>âœ…</span> Verified Guest
                    </div>
                    <?php endif; ?>
                </div>
                <?php endforeach; ?>
            </div>
        </div>
    </section>
    <?php endif; ?>

    <section class="section" id="gallery">
        <div class="container">
            <h2>Gallery</h2>
            <div class="gallery">
                <?php foreach ($gallery_images as $image): ?>
                <img src="<?= $image['url'] ?>" alt="<?= $image['alt'] ?>" loading="lazy">
                <?php endforeach; ?>
            </div>
        </div>
    </section>

    <section class="section" id="rules">
        <div class="container">
            <h2>House Rules</h2>
            <?php foreach ($rules as $rule): ?>
            <details class="expandable">
                <summary><?= $rule['title'] ?></summary>
                <div class="expandable-content">
                    <p><?= $rule['content'] ?></p>
                </div>
            </details>
            <?php endforeach; ?>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <p>&copy; <?= date('Y') ?> <?= $config['site_name'] ?>. All rights reserved.</p>
            <p>A-B Test Variant: <?= $button_variant ?> | Social Proof: <?= $social_proof_variant ?> | Urgency: <?= $urgency_variant ?></p>
        </div>
    </footer>

    <div class="floating-book" id="floatingBook">
        <button class="floating-toggle" onclick="toggleFloatingMenu()">
            Book Now
        </button>
        <div class="floating-menu">
            <a href="#rooms" onclick="gtag('event', 'click', {'event_category': 'Floating Menu', 'event_label': 'View Rooms'});">View Rooms</a>
            <a href="#packages" onclick="gtag('event', 'click', {'event_category': 'Floating Menu', 'event_label': 'Packages'});">Packages</a>
            <a href="#contact" onclick="gtag('event', 'click', {'event_category': 'Floating Menu', 'event_label': 'Contact'});">Contact Us</a>
            <a href="#book" onclick="gtag('event', 'click', {'event_category': 'Floating Menu', 'event_label': 'Book Instantly'});">Book Instantly</a>
        </div>
    </div>

    <?php if ($config['enable_exit_intent']): ?>
    <div id="exitIntentModal" class="exit-intent-modal">
        <div class="exit-intent-content">
            <span class="exit-intent-close" onclick="closeExitIntent()">&times;</span>
            <h3>Wait! Don't Miss Out</h3>
            <p>Get an exclusive 25% discount on your first booking!</p>
            
            <form method="POST" onsubmit="trackLeadCapture('exit_intent')" style="margin-top: 20px;">
                <input type="hidden" name="action" value="email_signup">
                <input type="hidden" name="source" value="exit_intent">
                <div class="lead-capture-form">
                    <input type="email" 
                           name="email" 
                           class="email-input" 
                           placeholder="Your email address..." 
                           required>
                    <button type="submit" class="email-submit">Claim Discount</button>
                </div>
            </form>
            
            <p style="font-size: 12px; color: #666; margin-top: 10px;">
                No spam, unsubscribe anytime. Privacy policy applies.
            </p>
        </div>
    </div>
    <?php endif; ?>

    <script>
        // Enhanced analytics tracking
        function trackLeadCapture(source) {
            gtag('event', 'generate_lead', {
                'event_category': 'Lead Capture',
                'event_label': source,
                'value': 1
            });
        }

        // Floating menu toggle
        function toggleFloatingMenu() {
            const floatingBook = document.getElementById('floatingBook');
            floatingBook.classList.toggle('open');
            
            gtag('event', 'click', {
                'event_category': 'Floating Menu',
                'event_label': 'Toggle'
            });
        }

        // Close promo banner
        function closeBanner() {
            const banner = document.getElementById('promoBanner');
            if (banner) {
                banner.style.display = 'none';
                
                gtag('event', 'click', {
                    'event_category': 'Promo Banner',
                    'event_label': 'Close'
                });
            }
        }

        // Exit intent detection
        let exitIntentShown = false;
        function detectExitIntent() {
            if (exitIntentShown) return;
            
            document.addEventListener('mouseleave', function(e) {
                if (e.clientY <= 0 && !exitIntentShown) {
                    const modal = document.getElementById('exitIntentModal');
                    if (modal) {
                        modal.style.display = 'flex';
                        exitIntentShown = true;
                        
                        gtag('event', 'exit_intent_shown', {
                            'event_category': 'Lead Capture',
                            'event_label': 'Exit Intent Modal'
                        });
                    }
                }
            });
        }

        function closeExitIntent() {
            const modal = document.getElementById('exitIntentModal');
            if (modal) {
                modal.style.display = 'none';
                
                gtag('event', 'exit_intent_closed', {
                    'event_category': 'Lead Capture',
                    'event_label': 'Manual Close'
                });
            }
        }

        // Close floating menu when clicking outside
        document.addEventListener('click', function(event) {
            const floatingBook = document.getElementById('floatingBook');
            if (floatingBook && !floatingBook.contains(event.target)) {
                floatingBook.classList.remove('open');
            }
        });

        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Track scroll depth for analytics
        let maxScroll = 0;
        window.addEventListener('scroll', function() {
            const scrollPercent = Math.round((window.scrollY / (document.body.scrollHeight - window.innerHeight)) * 100);
            if (scrollPercent > maxScroll) {
                maxScroll = scrollPercent;
                
                if (maxScroll >= 25 && maxScroll < 50) {
                    gtag('event', 'scroll', {'event_category': 'Engagement', 'event_label': '25%'});
                } else if (maxScroll >= 50 && maxScroll < 75) {
                    gtag('event', 'scroll', {'event_category': 'Engagement', 'event_label': '50%'});
                } else if (maxScroll >= 75) {
                    gtag('event', 'scroll', {'event_category': 'Engagement', 'event_label': '75%'});
                }
            }
        });

        // Track testimonial visibility
        function trackTestimonialView() {
            const testimonials = document.querySelectorAll('.testimonial-card');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        gtag('event', 'testimonial_view', {
                            'event_category': 'Social Proof',
                            'event_label': 'Testimonial Visible'
                        });
                        observer.unobserve(entry.target);
                    }
                });
            });
            
            testimonials.forEach(card => observer.observe(card));
        }

        // Enhanced scroll tracking for lead generation sections
        function trackSectionViews() {
            const sections = {
                'lead-capture-section': 'Lead Capture Section',
                'testimonials-grid': 'Testimonials Section',
                'trust-badges': 'Trust Badges'
            };
            
            Object.entries(sections).forEach(([className, label]) => {
                const element = document.querySelector(`.${className}`);
                if (element) {
                    const observer = new IntersectionObserver((entries) => {
                        if (entries[0].isIntersecting) {
                            gtag('event', 'section_view', {
                                'event_category': 'Engagement',
                                'event_label': label
                            });
                            observer.unobserve(element);
                        }
                    });
                    observer.observe(element);
                }
            });
        }

        // PHP A-B Testing Data
        const abTestData = {
            buttonVariant: '<?= $button_variant ?>',
            socialProof: '<?= $social_proof_variant ?>',
            urgencyLevel: '<?= $urgency_variant ?>'
        };

        // Send A-B test data to analytics
        gtag('event', 'ab_test_view', {
            'custom_parameter_1': abTestData.buttonVariant,
            'custom_parameter_2': abTestData.socialProof,
            'custom_parameter_3': abTestData.urgencyLevel
        });

        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            trackTestimonialView();
            trackSectionViews();
            
            // Initialize exit intent after 10 seconds
            setTimeout(detectExitIntent, 10000);
        });

        console.log('A-B Test Configuration:', abTestData);
    </script>
</body>
</html>
